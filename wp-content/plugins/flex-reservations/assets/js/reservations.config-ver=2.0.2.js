/** * Created by Manhn on 29/3/2017. */// console.log(ajax_data.time_work, ajax_data.holiday);/** * * @param email * @returns {boolean} */jQuery(document).ready(function ($) {    Reservation = function (element) {        this.defaults = {            fs_name: '',            fs_email: '',            fs_phone: '',            fs_partysize: 1,            fs_date: '',            fs_time: '',            fs_message: ''        };        /**         *         */        this.init = function () {            if (this.validate() === true) this.process();        };        /**         *         * @returns {boolean}         */        this.validate = function () {            var data = {};            for (var i in this.defaults) {                data[i] = (element.value[i] && typeof(element.value[i]) != 'undefined' && element.value[i].length > 0) ? element.value[i] : this.defaults[i];            }            var errors = new Array(),                name = new Array();            if (data !== Object(data)) {                return element.handle.error({                    type: 'invalid',                    errors: [                        'value'                    ]                });            }            // Begin to validate            for (var field in data) {                var field_value = data[field],                    isError = false;                switch (field) {                    case 'fs_name':                        if (validateEmpty(field_value)) {                            errors.push('fs_name_empty');                            isError = true;                        }                        if (!validateName(field_value)) {                            errors.push('fs_name_incorrect');                            isError = true;                        }                        break;                    case 'fs_email':                        if (validateEmpty(field_value)) {                            errors.push('fs_email_empty');                            isError = true;                        }                        if (!validateEmail(field_value)) {                            errors.push('fs_email_incorrect');                            isError = true;                        }                        break;                    case 'fs_phone':                        if (validateEmpty(field_value)) {                            errors.push('fs_phone_empty');                            isError = true;                        }                        if (!validatePhone(field_value)) {                            errors.push('fs_phone_incorrect');                            isError = true;                        }                        break;                    case 'fs_date':                        if (validateEmpty(field_value)) {                            errors.push('fs_date_empty');                            isError = true;                        }                        if (!validateDatetime(field_value)) {                            errors.push('fs_date_incorrect');                            isError = true;                        }                        if (!checkDayoff(field_value)) {                            errors.push('fs_dayoff');                            isError = true;                        }                        if (!checkHoliday(field_value)) {                            errors.push('fs_holiday');                            isError = true;                        }                        break;                    case 'fs_time':                        if (!checkTimeout(field_value)) {                            errors.push('fs_timeout');                            isError = true;                        }                        if (validateEmpty(field_value)) {                            errors.push('fs_time_empty');                            isError = true;                        }                        break;                }                if (isError === true) name.push(field);            }            if (!validateDatetime(data['fs_date'], data['fs_time'])) {                errors.push('fs_time_expired');                name.push('fs_date');                name.push('fs_time');            }            if (errors.length > 0) return element.handle.error({type: 'invalid', errors: errors, name: name});            // element.value = data;            return true;        }        /**         *         */        this.process = function () {            $.ajax({                url: ajax_data.url,                data: {                    action: ajax_data.add,                    body: element.value                },                type: 'POST',                dataType: 'json',                beforeSend: function () {                    if (element.handle.ajax_start()) element.handle.ajax_start();                }            }).done(function (response) {                if (response.type == "success") {                    if (element.handle.ajax_success)                        element.handle.ajax_success(response);                } else if (response.type == "invalid") {                    if (element.handle.error)                        element.handle.error(response);                }            }).fail(function (response) {                if (element.handle.ajax_fail)                    element.handle.ajax_fail(response);            }).always(function (response) {                if (element.handle.ajax_stop)                    element.handle.ajax_stop(response);            });        };        return this.init();    }});